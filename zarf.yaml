kind: ZarfPackageConfig
metadata:
  name: doug-translate
  version: 0.0.1
  description: >
    Translate, transcribe, and summarize audio recordings using a self-hosted OpenAI API.

variables:
  - name: LEAPFROGAI_BASE_URL
    description: The base URL for the Leapfrog AI API
    prompt: true
    sensitive: true
  - name: DOMAIN
    description: The domain to use for the application (istio-ingress shenanigans)
    prompt: true
    sensitive: true

components:
  - name: translate-ui
    required: true
    manifests:
      - name: translate-ui
        namespace: doug-translate
        files:
          - manifests/deploy.yaml
          - manifests/connect.yaml
          - manifests/istio.yaml
    images:
      - defenseunicorns/doug-translate:latest
    actions:
      onDeploy:
        # before:
        #   - cmd: ./zarf tools wait-for https ${ZARF_VAR_LEAPFROGAI_BASE_URL} success
        before:
          - cmd: ./zarf tools kubectl create namespace doug-translate
          - cmd: ./zarf tools kubectl label namespace doug-translate istio-injection=enabled
        after:
          - wait:
              cluster:
                kind: Deployment
                name: doug-translate-deloyment
                namespace: doug-translate
                condition: Available
